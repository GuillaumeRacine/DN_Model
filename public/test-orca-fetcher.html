<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Orca Fetcher</title>
</head>
<body>
    <h1>Testing Orca Fetcher in Browser</h1>
    <div id="results"></div>
    
    <script type="module">
        async function testOrcaFetcher() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Testing Orca fetcher...</p>';
            
            try {
                console.log('üß™ Testing Orca fetcher in browser environment');
                
                // Try to dynamically import the fetcher
                const { accurateOrcaFetcher } = await import('/lib/accurate-orca-fetcher.js');
                console.log('‚úÖ Successfully imported accurateOrcaFetcher');
                
                const positions = await accurateOrcaFetcher.getAccuratePositions();
                console.log(`üìä Found ${positions.length} positions:`, positions);
                
                if (positions.length > 0) {
                    let html = '<h2>‚úÖ SUCCESS: Found Orca Positions!</h2><ul>';
                    positions.forEach((pos, index) => {
                        html += `<li><strong>${pos.tokenPair}</strong>: $${pos.tvlUsd} (${pos.inRange ? 'IN RANGE' : 'OUT OF RANGE'})</li>`;
                    });
                    html += '</ul>';
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<h2>üî¥ NO POSITIONS FOUND</h2><p>This explains why the dashboard is empty!</p>';
                }
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultsDiv.innerHTML = `<h2>‚ùå ERROR</h2><p>${error.message}</p>`;
            }
        }
        
        // Run the test when page loads
        testOrcaFetcher();
    </script>
</body>
</html>